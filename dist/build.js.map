{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./js/libs/build.js"],"names":["Fliplet","Widget","instance","widgetData","DS_COMMENTS","DS_USERS","QUERY","Navigate","query","loggedUser","dataSourceEntryId","showToastMessage","initializeChildren","$el","initVue","message","UI","Toast","$","removeClass","then","Vue","el","data","commentInput","commentState","comments","computed","commentsLength","commentData","methods","showToastProgress","arguments","length","undefined","position","backdrop","tapToDismiss","duration","closeToastProgress","dismiss","flagComment","comment","thisy","flagged","DataSources","connectByName","connection","update","id","Flagged","GUID","setTimeout","toggleThreads","showThreads","getUserData","userEmails","find","where","Email","$in","attributes","records","getComments","entryId","map","users","threads","forEach","currentUser","user","userInitials","split","name","join","userAvatar","Media","authenticate","openDropdown","push","filter","thread","likedLoginByUser","likes","includes","isLoggedUserOwnerOfComment","getTimeFromTimestamp","timestamp","moment","format","getDateFromTimestamp","manageLike","Likes","prepareComment","action","manageComment","toInsert","Message","Timestamp","Date","toISOString","insert","record","deleteComment","isThread","options","title","labels","confirm","result","console","log","removeById","commit","append","extend","mounted","Session","get","session","_"],"mappings":"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","file":"build.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","Fliplet.Widget.instance('comments', function(widgetData) {\r\n  const DS_COMMENTS = 'Global Comments';\r\n  const DS_USERS = 'Users'; // Replace from the component settings\r\n  const QUERY = Fliplet.Navigate.query;\r\n  let loggedUser = null;\r\n\r\n  if (!QUERY.dataSourceEntryId) {\r\n    showToastMessage('No data source entry ID provided');\r\n  }\r\n\r\n  Fliplet.Widget.initializeChildren(this.$el, this);\r\n\r\n  initVue();\r\n  // loggedInUser();\r\n\r\n  // function loggedInUser() {\r\n  //   Fliplet.Session.get().then(function onCachedSessionRetrieved(session) {\r\n  //     loggedUser = _.get(session, 'entries.dataSource.data');\r\n\r\n  //     if (loggedUser) {\r\n  //       initVue();\r\n  //     } else {\r\n  //       showToastMessage('You need to be logged in to see the comments');\r\n  //     }\r\n  //   });\r\n  // }\r\n\r\n  function showToastMessage(message) {\r\n    return Fliplet.UI.Toast(message);\r\n  }\r\n\r\n  function initVue() {\r\n    $('[name=\"comments\"]').removeClass('hidden');\r\n    Fliplet().then(function() {\r\n      new Vue({\r\n        el: '#app-comments',\r\n        data: {\r\n          commentInput: '',\r\n          commentState: null,\r\n          message: 'Hello, Vue!',\r\n          comments: [\r\n            // {\r\n            //   id: 1,\r\n            //   liked: true,\r\n            //   likeCount: 5,\r\n            //   data: {\r\n            //     text: 'Comment 1',\r\n            //     userInitials: 'AB',\r\n            //     userFullName: 'Alicia B',\r\n            //     timestamp: '2020-01-01T00:00:00Z',\r\n            //     userAvatar: 'https://variety.com/wp-content/uploads/2020/12/Brad_Pitt.png'\r\n            //   },\r\n            //   threads: []\r\n            // },\r\n            // {\r\n            //   id: 2,\r\n            //   liked: true,\r\n            //   likeCount: 3,\r\n            //   data: {\r\n            //     text: 'Comment 2',\r\n            //     userInitials: 'CD',\r\n            //     userFullName: 'Cory D',\r\n            //     timestamp: '2020-01-02T00:00:00Z',\r\n            //     userAvatar: null\r\n            //   },\r\n            //   threads: [{\r\n            //     id: 2,\r\n            //     liked: true,\r\n            //     likeCount: 3,\r\n            //     data: {\r\n            //       text: 'Comment 2',\r\n            //       userInitials: 'CD',\r\n            //       userFullName: 'Cory D',\r\n            //       timestamp: '2020-01-02T00:00:00Z',\r\n            //       userAvatar: null\r\n            //     }\r\n            //   }]\r\n            // },\r\n            // {\r\n            //   id: 3,\r\n            //   liked: false,\r\n            //   likeCount: 7,\r\n            //   data: {\r\n            //     text: 'Comment 3',\r\n            //     userInitials: 'EF',\r\n            //     userFullName: 'Evan F',\r\n            //     timestamp: '2020-01-03T00:00:00Z',\r\n            //     userAvatar: null\r\n            //   },\r\n            //   threads: [{\r\n            //     id: 3,\r\n            //     liked: false,\r\n            //     likeCount: 0,\r\n            //     data: {\r\n            //       text: 'Comment 3',\r\n            //       userInitials: 'EF',\r\n            //       userFullName: 'Evan F',\r\n            //       timestamp: '2020-01-03T00:00:00Z',\r\n            //       userAvatar: 'https://variety.com/wp-content/uploads/2020/12/Brad_Pitt.png'\r\n            //     }\r\n            //   }]\r\n            // }\r\n          ]\r\n        },\r\n        computed: {\r\n          commentsLength: function() {\r\n            return this.message + ' text';\r\n          },\r\n          commentData() {\r\n            return this.comments;\r\n          }\r\n        },\r\n        methods: {\r\n          showToastProgress(message = 'Processing') {\r\n            Fliplet.UI.Toast({\r\n              message,\r\n              position: 'center',\r\n              backdrop: true,\r\n              tapToDismiss: false,\r\n              duration: false\r\n            });\r\n          },\r\n          closeToastProgress() {\r\n            Fliplet.UI.Toast.dismiss();\r\n          },\r\n          flagComment(comment) {\r\n            var thisy = this;\r\n\r\n            thisy.showToastProgress('Flagging comment...');\r\n            // todo notify admin from the component settings\r\n            comment.data.flagged = true;\r\n            Fliplet.DataSources.connectByName(DS_COMMENTS).then(function(\r\n              connection\r\n            ) {\r\n              return connection.update(comment.id, {\r\n                Flagged: comment.data.flagged,\r\n                GUID: comment.data.GUID\r\n              }).then(() => {\r\n                thisy.closeToastProgress();\r\n              });\r\n            }).then(() => {\r\n              setTimeout(() => {\r\n                comment.data.flagged = false;\r\n              }, 2000);\r\n            });\r\n          },\r\n          toggleThreads(comment) {\r\n            comment.showThreads = !comment.showThreads;\r\n          },\r\n          getUserData(userEmails) {\r\n            return Fliplet.DataSources.connectByName(DS_USERS).then(function(\r\n              connection\r\n            ) {\r\n              return connection\r\n                .find({\r\n                  where: { Email: { $in: userEmails } },\r\n                  attributes: ['Email', 'User Full Name', 'User Avatar']\r\n                })\r\n                .then(function(records) {\r\n                  return records;\r\n                });\r\n            });\r\n          },\r\n          getComments() {\r\n            var thisy = this;\r\n\r\n            thisy.showToastProgress('Loading comments...');\r\n\r\n            var entryId = '123456'; // Replace with the entry ID from the url\r\n\r\n            return Fliplet.DataSources.connectByName(DS_COMMENTS).then(\r\n              function(connection) {\r\n                return connection\r\n                  .find({ where: { 'Entry Id': entryId } })\r\n                  .then(function(records) {\r\n                    var userEmails = records.map(\r\n                      (el) => el.data['Author Email']\r\n                    );\r\n\r\n                    return thisy.getUserData(userEmails).then(function(users) {\r\n                      var comments = [];\r\n                      var threads = [];\r\n\r\n                      records.forEach((el) => {\r\n                        var currentUser = users.find(\r\n                          (user) => user.data['Email'] === el.data['Author Email']\r\n                        );\r\n\r\n                        el.data.userInitials = (currentUser.data['User Full Name'] || '')\r\n                          .split(' ')\r\n                          .map((name) => name[0])\r\n                          .join('');\r\n                        el.data.userAvatar = currentUser.data['User Avatar']\r\n                          ? Fliplet.Media.authenticate(currentUser.data['User Avatar'])\r\n                          : null;\r\n                        el.data.flagged = false;\r\n                        el.data.openDropdown = false;\r\n\r\n                        if (el.data['Comment GUID']) {\r\n                          threads.push(el);\r\n                        } else {\r\n                          comments.push(el);\r\n                        }\r\n                      });\r\n                      debugger;\r\n                      thisy.comments = comments.map((el) => {\r\n                        el.showThreads = false;\r\n                        el.threads = threads.filter(\r\n                          (thread) =>\r\n                            thread.data['Comment GUID'] === el.data['GUID']\r\n                        );\r\n\r\n                        return el;\r\n                      });\r\n\r\n                      thisy.closeToastProgress();\r\n                    });\r\n                  });\r\n              }\r\n            );\r\n          },\r\n          likedLoginByUser(likes) {\r\n            return likes.includes(loggedUser.Email); // logged user email\r\n          },\r\n          isLoggedUserOwnerOfComment(comment) {\r\n            return comment.data['Author Email'] === loggedUser.Email;\r\n          },\r\n          getTimeFromTimestamp: function(timestamp) {\r\n            return moment(timestamp).format('HH:mm');\r\n          },\r\n          getDateFromTimestamp: function(timestamp) {\r\n            return moment(timestamp).format('MM/DD/YYYY');\r\n          },\r\n          manageLike(comment) {\r\n            if (this.likedLoginByUser(comment.data.Likes)) {\r\n              comment.data.Likes = comment.data.Likes.filter(\r\n                (el) => el !== loggedUser.Email\r\n              );\r\n            } else {\r\n              comment.data.Likes.push(loggedUser.Email);\r\n            }\r\n\r\n            Fliplet.DataSources.connectByName(DS_COMMENTS).then(function(\r\n              connection\r\n            ) {\r\n              return connection.update(comment.id, {\r\n                Likes: comment.data.Likes,\r\n                GUID: comment.data.GUID\r\n              });\r\n            });\r\n          },\r\n          prepareComment(comment, action) {\r\n            this.commentState = {\r\n              comment,\r\n              action\r\n            };\r\n          },\r\n          manageComment() {\r\n            // todo add showToastProgress for edit/add comment\r\n            var thisy = this;\r\n\r\n            if (thisy.commentInput) {\r\n              thisy.showToastProgress('Adding comment...');\r\n\r\n              if (!thisy.commentState || thisy.commentState.action === 'reply') {\r\n                Fliplet.DataSources.connectByName(DS_COMMENTS).then(function(\r\n                  connection\r\n                ) {\r\n                  var toInsert = {\r\n                    Message: thisy.commentInput,\r\n                    'Author Email': loggedUser.Email,\r\n                    Timestamp: new Date().toISOString(),\r\n                    'Entry Id': QUERY.dataSourceEntryId,\r\n                    Likes: []\r\n                  };\r\n\r\n                  if (thisy.commentState.action === 'reply') {\r\n                    toInsert['Comment GUID'] = thisy.commentState.comment.data['GUID'];\r\n                  }\r\n\r\n                  return connection.insert(toInsert).then(function(record) {\r\n                    record.userInitials = (loggedUser['User Full Name'] || '')\r\n                      .split(' ')\r\n                      .map((name) => name[0])\r\n                      .join('');\r\n                    record.userAvatar = loggedUser['User Avatar']\r\n                      ? Fliplet.Media.authenticate(loggedUser['User Avatar'])\r\n                      : null;\r\n                    record.data.flagged = false;\r\n                    record.data.openDropdown = false;\r\n                    record.showThreads = false;\r\n                    record.threads = [];\r\n\r\n                    thisy.comments.push(record);\r\n                    thisy.closeToastProgress();\r\n                    thisy.commentInput = '';\r\n                    thisy.commentState = null;\r\n                  });\r\n                });\r\n              } else {\r\n                Fliplet.DataSources.connectByName(DS_COMMENTS).then(function(\r\n                  connection\r\n                ) {\r\n                  return connection.update(thisy.commentState.comment.id, {\r\n                    Message: thisy.commentInput,\r\n                    GUID: thisy.commentState.comment.data['GUID']\r\n                  }).then(function() {\r\n                    thisy.closeToastProgress();\r\n                    thisy.commentInput = '';\r\n                    thisy.commentState = null;\r\n                  });\r\n                });\r\n              }\r\n            }\r\n          },\r\n          deleteComment(comment, isThread = false) {\r\n            var thisy = this;\r\n            var options = {\r\n              title: 'Delete comment?',\r\n              message: 'Are you sure you want to delete this comment?',\r\n              labels: ['Agree', 'No'] // Native only (defaults to [OK,Cancel])\r\n            };\r\n\r\n            Fliplet.Navigate.confirm(options)\r\n              .then(function(result) {\r\n                if (!result) {\r\n                  return console.log('Not confirmed!');\r\n                }\r\n\r\n                thisy.showToastProgress('Deleting comment...');\r\n\r\n                if (isThread) {\r\n                  return Fliplet.DataSources.connectByName(DS_COMMENTS).then(function(\r\n                    connection\r\n                  ) {\r\n                    return connection.removeById(comment.id).then(function() {\r\n                      thisy.comments = thisy.comments.map(el => {\r\n                        if (el.data['GUID'] === comment.data['Comment GUID']) {\r\n                          el.threads = el.threads.filter((el) => el.id !== comment.id);\r\n                        }\r\n\r\n                        return el;\r\n                      });\r\n\r\n                      thisy.closeToastProgress();\r\n                    });\r\n                  });\r\n                }\r\n\r\n                return Fliplet.DataSources.connectByName(DS_COMMENTS).then(function(\r\n                  connection\r\n                ) {\r\n                  return connection.find({ where: { 'Comment GUID': comment.data.GUID } }).then(function(records) {\r\n                    return connection.commit({\r\n                      delete: records.map((el) => el.id),\r\n                      append: true,\r\n                      extend: true\r\n                    }).then(function() {\r\n                      return connection.removeById(comment.id).then(function() {\r\n                        thisy.comments = thisy.comments.filter((el) => el.id !== comment.id);\r\n                        thisy.closeToastProgress();\r\n                      });\r\n                    });\r\n                  });\r\n                });\r\n              });\r\n          }\r\n        },\r\n        mounted() {\r\n          var thisy = this;\r\n\r\n          Fliplet.Session.get().then((session) => {\r\n            loggedUser = _.get(session, 'entries.dataSource.data');\r\n\r\n            if (loggedUser) {\r\n              //  initVue();\r\n              debugger;\r\n              thisy.getComments();\r\n            } else {\r\n              showToastMessage('You need to be logged in to see the comments');\r\n            }\r\n          });\r\n        }\r\n      });\r\n    });\r\n  }\r\n});\r\n"],"sourceRoot":""}